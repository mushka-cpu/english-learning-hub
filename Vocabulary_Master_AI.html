<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulary Master AI - Learn English with AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Work+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2d3561;
            --secondary: #c05c7e;
            --accent: #f3826f;
            --success: #6c9a8b;
            --warning: #f7b267;
            --bg-light: #fef6f0;
            --bg-card: #ffffff;
            --text-dark: #2d3561;
            --text-light: #6b7280;
            --shadow: 0 4px 20px rgba(45, 53, 97, 0.1);
        }
        
        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, var(--bg-light) 0%, #fff9f4 100%);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, #3d4575 100%);
            color: white;
            padding: 40px 30px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .app-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .app-header h1 {
            font-family: 'Libre Baskerville', serif;
            font-size: 42px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .app-header p {
            font-size: 18px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        /* Stats Dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--text-light);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .nav-tab {
            background: var(--bg-card);
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            border: 3px solid transparent;
            white-space: nowrap;
            font-weight: 600;
        }
        
        .nav-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(45, 53, 97, 0.15);
        }
        
        .nav-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--accent);
        }
        
        /* Content Panels */
        .panel {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .panel.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .panel-card {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
        }
        
        .panel-header {
            font-family: 'Libre Baskerville', serif;
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--accent);
        }
        
        /* Vocabulary Items */
        .vocab-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .vocab-item {
            background: linear-gradient(135deg, #fff 0%, var(--bg-light) 100%);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid var(--secondary);
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .vocab-item:hover {
            transform: translateX(10px);
            box-shadow: var(--shadow);
        }
        
        .vocab-word {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .vocab-type {
            display: inline-block;
            background: var(--warning);
            color: white;
            padding: 3px 12px;
            border-radius: 20px;
            font-size: 12px;
            margin-left: 10px;
            font-weight: 600;
        }
        
        .vocab-definition {
            color: var(--text-light);
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .vocab-example {
            font-style: italic;
            color: var(--text-light);
            padding: 10px;
            background: rgba(192, 92, 126, 0.1);
            border-radius: 8px;
            margin-top: 10px;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--primary);
            font-size: 16px;
        }
        
        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-family: inherit;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(45, 53, 97, 0.1);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        /* Buttons */
        .btn {
            padding: 15px 35px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, #3d4575 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(45, 53, 97, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(45, 53, 97, 0.4);
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-accent {
            background: var(--accent);
            color: white;
        }
        
        /* Exercise Components */
        .exercise-container {
            margin-top: 30px;
        }
        
        .exercise-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .exercise-type-card {
            background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-light) 100%);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: var(--shadow);
        }
        
        .exercise-type-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
        }
        
        .exercise-type-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }
        
        .exercise-type-title {
            font-weight: 700;
            font-size: 20px;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .exercise-type-desc {
            color: var(--text-light);
            font-size: 14px;
        }
        
        .question-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .question-card.correct {
            border-color: var(--success);
            background: linear-gradient(135deg, #fff 0%, #f0f9f6 100%);
        }
        
        .question-card.incorrect {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fff 0%, #fef2f2 100%);
        }
        
        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .options-grid {
            display: grid;
            gap: 12px;
        }
        
        .option-btn {
            padding: 15px;
            background: var(--bg-light);
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 16px;
        }
        
        .option-btn:hover {
            background: #f3e8e0;
            border-color: var(--primary);
        }
        
        .option-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .option-btn.correct {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .option-btn.incorrect {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 18px;
            font-family: inherit;
        }
        
        .answer-input.correct {
            border-color: var(--success);
            background: #f0f9f6;
        }
        
        .answer-input.incorrect {
            border-color: #ef4444;
            background: #fef2f2;
        }
        
        /* Results */
        .results-card {
            background: linear-gradient(135deg, var(--success) 0%, #5a8a7d 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 8px 30px rgba(108, 154, 139, 0.3);
        }
        
        .results-score {
            font-size: 72px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .results-message {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        /* AI Loading */
        .ai-loading {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: linear-gradient(135deg, var(--bg-light) 0%, #fff 100%);
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Topic Filter */
        .topic-filter {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .topic-chip {
            padding: 8px 20px;
            background: var(--bg-light);
            border: 2px solid #e5e7eb;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }
        
        .topic-chip:hover {
            border-color: var(--primary);
        }
        
        .topic-chip.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Alert Messages */
        .alert {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-left: 5px solid var(--success);
        }
        
        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 5px solid #3b82f6;
        }
        
        .alert-warning {
            background: #fed7aa;
            color: #92400e;
            border-left: 5px solid var(--warning);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .app-header h1 {
                font-size: 28px;
            }
            
            .panel-card {
                padding: 25px;
            }
            
            .exercise-type-selector {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="app-header">
            <h1>üß† Vocabulary Master AI</h1>
            <p>–î–æ–±–∞–≤–ª—è–π —Å–ª–æ–≤–∞, —Ñ—Ä–∞–∑—ã –∏ –∏–¥–∏–æ–º—ã ‚Äî AI —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏</p>
        </div>
        
        <!-- Stats Dashboard -->
        <div class="stats-dashboard">
            <div class="stat-card">
                <div class="stat-icon">üìö</div>
                <div class="stat-number" id="totalWords">0</div>
                <div class="stat-label">Total Words</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üéØ</div>
                <div class="stat-number" id="exercisesCompleted">0</div>
                <div class="stat-label">Exercises Done</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-number" id="correctAnswers">0</div>
                <div class="stat-label">Correct Answers</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üî•</div>
                <div class="stat-number" id="streakDays">0</div>
                <div class="stat-label">Day Streak</div>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showPanel('vocabulary')">
                üìñ My Vocabulary
            </div>
            <div class="nav-tab" onclick="showPanel('add')">
                ‚ûï Add Words
            </div>
            <div class="nav-tab" onclick="showPanel('practice')">
                üéÆ Practice
            </div>
        </div>
        
        <!-- Vocabulary Panel -->
        <div id="vocabulary-panel" class="panel active">
            <div class="panel-card">
                <h2 class="panel-header">üìñ My Vocabulary Bank</h2>
                
                <div class="topic-filter" id="topicFilter">
                    <div class="topic-chip active" data-topic="all">All</div>
                </div>
                
                <div class="vocab-grid" id="vocabList"></div>
                
                <div id="emptyState" style="text-align: center; padding: 60px 20px; display: none;">
                    <div style="font-size: 80px; margin-bottom: 20px;">üìö</div>
                    <h3 style="color: var(--text-light); margin-bottom: 10px;">No vocabulary yet</h3>
                    <p style="color: var(--text-light);">Start adding words to build your collection!</p>
                </div>
            </div>
        </div>
        
        <!-- Add Words Panel -->
        <div id="add-panel" class="panel">
            <div class="panel-card">
                <h2 class="panel-header">‚ûï Add New Vocabulary</h2>
                
                <div class="alert alert-info">
                    <strong>üí° Tip:</strong> –î–æ–±–∞–≤–ª—è–π —Å–ª–æ–≤–∞, —Ñ—Ä–∞–∑—ã –∏ –∏–¥–∏–æ–º—ã. AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è –∏—Ö –æ—Ç—Ä–∞–±–æ—Ç–∫–∏!
                </div>
                
                <form id="addForm" onsubmit="addVocabulary(event)">
                    <div class="form-group">
                        <label class="form-label">Topic / Category</label>
                        <select class="form-select" id="topicSelect" required>
                            <option value="">Choose or create new...</option>
                            <option value="Business">üíº Business</option>
                            <option value="Travel">‚úàÔ∏è Travel</option>
                            <option value="Food">üçï Food & Cooking</option>
                            <option value="Technology">üíª Technology</option>
                            <option value="Health">üè• Health & Fitness</option>
                            <option value="Education">üìö Education</option>
                            <option value="Custom">‚úèÔ∏è Create New Topic</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="customTopicGroup" style="display: none;">
                        <label class="form-label">Custom Topic Name</label>
                        <input type="text" class="form-input" id="customTopic" placeholder="Enter topic name...">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select class="form-select" id="vocabType" required>
                            <option value="word">üìù Word</option>
                            <option value="phrase">üí¨ Phrase</option>
                            <option value="idiom">üé≠ Idiom</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Word / Phrase / Idiom</label>
                        <input type="text" class="form-input" id="vocabWord" placeholder="e.g., 'break the ice'" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Definition / Meaning</label>
                        <textarea class="form-textarea" id="vocabDefinition" placeholder="e.g., 'to make people feel more comfortable'" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Example Sentence</label>
                        <textarea class="form-textarea" id="vocabExample" placeholder="e.g., 'He told a joke to break the ice at the meeting.'" required></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        üíæ Save Vocabulary
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="clearForm()">
                        üóëÔ∏è Clear
                    </button>
                </form>
                
                <div id="addSuccess" class="alert alert-success" style="display: none;"></div>
            </div>
        </div>
        
        <!-- Practice Panel -->
        <div id="practice-panel" class="panel">
            <div class="panel-card">
                <h2 class="panel-header">üéÆ Practice & Learn</h2>
                
                <div id="practiceSetup">
                    <div class="form-group">
                        <label class="form-label">Select Topic to Practice</label>
                        <select class="form-select" id="practiceTopicSelect" onchange="showExerciseTypes()">
                            <option value="">Choose a topic...</option>
                        </select>
                    </div>
                    
                    <div id="exerciseTypeSelector" style="display: none;">
                        <h3 style="margin: 30px 0 20px; color: var(--primary);">Choose Exercise Type</h3>
                        <div class="exercise-type-selector">
                            <div class="exercise-type-card" onclick="generateExercise('multiple-choice')">
                                <div class="exercise-type-icon">‚úÖ</div>
                                <div class="exercise-type-title">Multiple Choice</div>
                                <div class="exercise-type-desc">Choose the correct definition</div>
                            </div>
                            
                            <div class="exercise-type-card" onclick="generateExercise('fill-blank')">
                                <div class="exercise-type-icon">üìù</div>
                                <div class="exercise-type-title">Fill in the Blank</div>
                                <div class="exercise-type-desc">Complete the sentence</div>
                            </div>
                            
                            <div class="exercise-type-card" onclick="generateExercise('matching')">
                                <div class="exercise-type-icon">üîó</div>
                                <div class="exercise-type-title">Matching</div>
                                <div class="exercise-type-desc">Match words with definitions</div>
                            </div>
                            
                            <div class="exercise-type-card" onclick="generateExercise('sentence-builder')">
                                <div class="exercise-type-icon">üèóÔ∏è</div>
                                <div class="exercise-type-title">Sentence Builder</div>
                                <div class="exercise-type-desc">Create your own sentences</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="exerciseContent" class="exercise-container"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Data Storage
        let vocabulary = loadVocabulary();
        let stats = loadStats();
        
        // Load data from localStorage
        function loadVocabulary() {
            const stored = localStorage.getItem('vocabularyMaster');
            return stored ? JSON.parse(stored) : [];
        }
        
        function loadStats() {
            const stored = localStorage.getItem('vocabularyStats');
            return stored ? JSON.parse(stored) : {
                exercisesCompleted: 0,
                correctAnswers: 0,
                totalAnswers: 0,
                streakDays: 0,
                lastPractice: null
            };
        }
        
        function saveData() {
            localStorage.setItem('vocabularyMaster', JSON.stringify(vocabulary));
            localStorage.setItem('vocabularyStats', JSON.stringify(stats));
            updateStats();
        }
        
        // Update statistics display
        function updateStats() {
            document.getElementById('totalWords').textContent = vocabulary.length;
            document.getElementById('exercisesCompleted').textContent = stats.exercisesCompleted;
            document.getElementById('correctAnswers').textContent = stats.correctAnswers;
            document.getElementById('streakDays').textContent = stats.streakDays;
        }
        
        // Panel Navigation
        function showPanel(panelName) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(panelName + '-panel').classList.add('active');
            event.target.classList.add('active');
            
            if (panelName === 'vocabulary') {
                displayVocabulary();
            } else if (panelName === 'practice') {
                loadPracticeTopics();
            }
        }
        
        // Display vocabulary list
        function displayVocabulary(filterTopic = 'all') {
            const container = document.getElementById('vocabList');
            const emptyState = document.getElementById('emptyState');
            
            if (vocabulary.length === 0) {
                emptyState.style.display = 'block';
                container.innerHTML = '';
                return;
            }
            
            emptyState.style.display = 'none';
            
            const filtered = filterTopic === 'all' ? 
                vocabulary : 
                vocabulary.filter(v => v.topic === filterTopic);
            
            container.innerHTML = filtered.map((item, index) => `
                <div class="vocab-item">
                    <div class="vocab-word">
                        ${item.word}
                        <span class="vocab-type">${item.type}</span>
                    </div>
                    <div class="vocab-definition">${item.definition}</div>
                    <div class="vocab-example">"${item.example}"</div>
                    <div style="margin-top: 15px; color: var(--text-light); font-size: 14px;">
                        üìÇ ${item.topic}
                    </div>
                </div>
            `).join('');
            
            updateTopicFilter();
        }
        
        // Update topic filter chips
        function updateTopicFilter() {
            const topics = [...new Set(vocabulary.map(v => v.topic))];
            const container = document.getElementById('topicFilter');
            
            container.innerHTML = `
                <div class="topic-chip active" onclick="filterVocabulary('all')">All (${vocabulary.length})</div>
                ${topics.map(topic => {
                    const count = vocabulary.filter(v => v.topic === topic).length;
                    return `<div class="topic-chip" onclick="filterVocabulary('${topic}')">${topic} (${count})</div>`;
                }).join('')}
            `;
        }
        
        function filterVocabulary(topic) {
            document.querySelectorAll('.topic-chip').forEach(chip => chip.classList.remove('active'));
            event.target.classList.add('active');
            displayVocabulary(topic);
        }
        
        // Handle custom topic input
        document.getElementById('topicSelect').addEventListener('change', function() {
            const customGroup = document.getElementById('customTopicGroup');
            customGroup.style.display = this.value === 'Custom' ? 'block' : 'none';
        });
        
        // Add vocabulary
        function addVocabulary(event) {
            event.preventDefault();
            
            const topicSelect = document.getElementById('topicSelect').value;
            const customTopic = document.getElementById('customTopic').value.trim();
            const topic = topicSelect === 'Custom' ? customTopic : topicSelect;
            
            const newItem = {
                id: Date.now(),
                topic: topic,
                type: document.getElementById('vocabType').value,
                word: document.getElementById('vocabWord').value.trim(),
                definition: document.getElementById('vocabDefinition').value.trim(),
                example: document.getElementById('vocabExample').value.trim(),
                dateAdded: new Date().toISOString()
            };
            
            vocabulary.push(newItem);
            saveData();
            
            // Show success message
            const successMsg = document.getElementById('addSuccess');
            successMsg.textContent = `‚úÖ Added "${newItem.word}" to ${topic}!`;
            successMsg.style.display = 'block';
            
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
            
            clearForm();
        }
        
        function clearForm() {
            document.getElementById('addForm').reset();
            document.getElementById('customTopicGroup').style.display = 'none';
        }
        
        // Load practice topics
        function loadPracticeTopics() {
            const select = document.getElementById('practiceTopicSelect');
            const topics = [...new Set(vocabulary.map(v => v.topic))];
            
            select.innerHTML = '<option value="">Choose a topic...</option>' +
                topics.map(topic => {
                    const count = vocabulary.filter(v => v.topic === topic).length;
                    return `<option value="${topic}">${topic} (${count} items)</option>`;
                }).join('');
        }
        
        function showExerciseTypes() {
            const topic = document.getElementById('practiceTopicSelect').value;
            const selector = document.getElementById('exerciseTypeSelector');
            
            if (topic) {
                selector.style.display = 'block';
            } else {
                selector.style.display = 'none';
            }
            
            document.getElementById('exerciseContent').innerHTML = '';
        }
        
        // Generate exercises
        let currentExercise = null;
        
        function generateExercise(type) {
            const topic = document.getElementById('practiceTopicSelect').value;
            const items = vocabulary.filter(v => v.topic === topic);
            
            if (items.length < 3) {
                alert('Need at least 3 items in this topic to practice!');
                return;
            }
            
            // Select random items
            const selected = items.sort(() => Math.random() - 0.5).slice(0, Math.min(5, items.length));
            
            currentExercise = {
                type: type,
                items: selected,
                answers: [],
                startTime: Date.now()
            };
            
            const container = document.getElementById('exerciseContent');
            container.innerHTML = '<div class="ai-loading"><div class="spinner"></div><div>AI is generating your exercise...</div></div>';
            
            // Simulate AI generation with delay
            setTimeout(() => {
                if (type === 'multiple-choice') {
                    generateMultipleChoice(selected, container);
                } else if (type === 'fill-blank') {
                    generateFillBlank(selected, container);
                } else if (type === 'matching') {
                    generateMatching(selected, container);
                } else if (type === 'sentence-builder') {
                    generateSentenceBuilder(selected, container);
                }
            }, 1500);
        }
        
        // Multiple Choice Exercise
        function generateMultipleChoice(items, container) {
            container.innerHTML = `
                <h3 style="color: var(--primary); margin-bottom: 25px;">‚úÖ Multiple Choice Exercise</h3>
                <p style="color: var(--text-light); margin-bottom: 30px;">Choose the correct definition for each word or phrase.</p>
            `;
            
            items.forEach((item, index) => {
                const allItems = vocabulary.filter(v => v.topic === item.topic);
                const wrongOptions = allItems
                    .filter(v => v.id !== item.id)
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 2);
                
                const options = [item, ...wrongOptions].sort(() => Math.random() - 0.5);
                
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card';
                questionDiv.innerHTML = `
                    <div class="question-text">${index + 1}. What does "${item.word}" mean?</div>
                    <div class="options-grid">
                        ${options.map((opt, i) => `
                            <div class="option-btn" data-correct="${opt.id === item.id}" data-question="${index}" onclick="selectOption(this, ${index})">
                                ${opt.definition}
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(questionDiv);
            });
            
            const checkBtn = document.createElement('button');
            checkBtn.className = 'btn btn-primary';
            checkBtn.textContent = '‚úì Check Answers';
            checkBtn.style.marginTop = '30px';
            checkBtn.onclick = () => checkMultipleChoice(items.length);
            
            container.appendChild(checkBtn);
        }
        
        function selectOption(element, questionIndex) {
            const siblings = element.parentElement.querySelectorAll('.option-btn');
            siblings.forEach(s => s.classList.remove('selected'));
            element.classList.add('selected');
        }
        
        function checkMultipleChoice(totalQuestions) {
            let correct = 0;
            
            document.querySelectorAll('.question-card').forEach((card, index) => {
                const selected = card.querySelector('.option-btn.selected');
                const allOptions = card.querySelectorAll('.option-btn');
                
                allOptions.forEach(opt => {
                    if (opt.dataset.correct === 'true') {
                        opt.classList.add('correct');
                    } else if (opt.classList.contains('selected')) {
                        opt.classList.add('incorrect');
                    }
                    opt.style.pointerEvents = 'none';
                });
                
                if (selected && selected.dataset.correct === 'true') {
                    correct++;
                    card.classList.add('correct');
                } else {
                    card.classList.add('incorrect');
                }
            });
            
            showResults(correct, totalQuestions);
        }
        
        // Fill in the Blank Exercise
        function generateFillBlank(items, container) {
            container.innerHTML = `
                <h3 style="color: var(--primary); margin-bottom: 25px;">üìù Fill in the Blank</h3>
                <p style="color: var(--text-light); margin-bottom: 30px;">Complete each sentence with the correct word or phrase.</p>
            `;
            
            items.forEach((item, index) => {
                // Create a sentence with blank
                const words = item.example.split(' ');
                const targetWord = item.word.toLowerCase();
                
                // Find the word in example and replace with blank
                let sentenceWithBlank = item.example;
                const wordVariations = [
                    item.word,
                    item.word.toLowerCase(),
                    item.word.charAt(0).toUpperCase() + item.word.slice(1).toLowerCase()
                ];
                
                for (let variation of wordVariations) {
                    if (sentenceWithBlank.includes(variation)) {
                        sentenceWithBlank = sentenceWithBlank.replace(variation, '_____');
                        break;
                    }
                }
                
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card';
                questionDiv.innerHTML = `
                    <div class="question-text">${index + 1}. ${sentenceWithBlank}</div>
                    <input type="text" class="answer-input" id="blank${index}" placeholder="Type your answer here..." data-answer="${item.word.toLowerCase()}">
                    <div style="margin-top: 10px; color: var(--text-light); font-size: 14px;">üí° Hint: ${item.definition}</div>
                `;
                
                container.appendChild(questionDiv);
            });
            
            const checkBtn = document.createElement('button');
            checkBtn.className = 'btn btn-primary';
            checkBtn.textContent = '‚úì Check Answers';
            checkBtn.style.marginTop = '30px';
            checkBtn.onclick = () => checkFillBlank(items);
            
            container.appendChild(checkBtn);
        }
        
        function checkFillBlank(items) {
            let correct = 0;
            
            items.forEach((item, index) => {
                const input = document.getElementById('blank' + index);
                const answer = input.value.trim().toLowerCase();
                const correctAnswer = item.word.toLowerCase();
                const card = input.closest('.question-card');
                
                if (answer === correctAnswer) {
                    input.classList.add('correct');
                    card.classList.add('correct');
                    correct++;
                } else {
                    input.classList.add('incorrect');
                    card.classList.add('incorrect');
                    // Show correct answer
                    const hint = document.createElement('div');
                    hint.style.cssText = 'margin-top: 10px; color: #ef4444; font-weight: 600;';
                    hint.textContent = `Correct answer: ${item.word}`;
                    card.appendChild(hint);
                }
                
                input.disabled = true;
            });
            
            showResults(correct, items.length);
        }
        
        // Matching Exercise
        function generateMatching(items, container) {
            container.innerHTML = `
                <h3 style="color: var(--primary); margin-bottom: 25px;">üîó Matching Exercise</h3>
                <p style="color: var(--text-light); margin-bottom: 30px;">Match each word with its correct definition.</p>
                <div class="alert alert-info">Click a word, then click its matching definition.</div>
            `;
            
            const words = items.map(item => ({type: 'word', text: item.word, id: item.id}));
            const definitions = items.map(item => ({type: 'definition', text: item.definition, id: item.id}));
            
            const shuffledDefs = definitions.sort(() => Math.random() - 0.5);
            
            const matchingContainer = document.createElement('div');
            matchingContainer.style.cssText = 'display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;';
            
            const wordsColumn = document.createElement('div');
            const defsColumn = document.createElement('div');
            
            words.forEach(word => {
                const wordBtn = document.createElement('div');
                wordBtn.className = 'option-btn';
                wordBtn.textContent = word.text;
                wordBtn.dataset.id = word.id;
                wordBtn.dataset.type = 'word';
                wordBtn.onclick = () => selectMatching(wordBtn);
                wordsColumn.appendChild(wordBtn);
            });
            
            shuffledDefs.forEach(def => {
                const defBtn = document.createElement('div');
                defBtn.className = 'option-btn';
                defBtn.textContent = def.text;
                defBtn.dataset.id = def.id;
                defBtn.dataset.type = 'definition';
                defBtn.onclick = () => selectMatching(defBtn);
                defsColumn.appendChild(defBtn);
            });
            
            matchingContainer.appendChild(wordsColumn);
            matchingContainer.appendChild(defsColumn);
            container.appendChild(matchingContainer);
            
            const checkBtn = document.createElement('button');
            checkBtn.className = 'btn btn-primary';
            checkBtn.textContent = '‚úì Check Matches';
            checkBtn.style.marginTop = '30px';
            checkBtn.onclick = checkMatching;
            
            container.appendChild(checkBtn);
        }
        
        let matchingSelections = [];
        
        function selectMatching(element) {
            if (element.classList.contains('correct') || element.classList.contains('incorrect')) {
                return;
            }
            
            if (matchingSelections.length === 0) {
                element.classList.add('selected');
                matchingSelections.push(element);
            } else if (matchingSelections.length === 1) {
                const first = matchingSelections[0];
                
                if (first.dataset.type === element.dataset.type) {
                    first.classList.remove('selected');
                    element.classList.add('selected');
                    matchingSelections = [element];
                } else {
                    element.classList.add('selected');
                    
                    if (first.dataset.id === element.dataset.id) {
                        setTimeout(() => {
                            first.classList.remove('selected');
                            first.classList.add('correct');
                            element.classList.remove('selected');
                            element.classList.add('correct');
                            matchingSelections = [];
                        }, 300);
                    } else {
                        setTimeout(() => {
                            first.classList.remove('selected');
                            element.classList.remove('selected');
                            matchingSelections = [];
                        }, 500);
                    }
                }
            }
        }
        
        function checkMatching() {
            const allButtons = document.querySelectorAll('.option-btn');
            let correct = 0;
            let total = 0;
            
            allButtons.forEach(btn => {
                if (btn.dataset.type === 'word') {
                    total++;
                    if (btn.classList.contains('correct')) {
                        correct++;
                    }
                }
            });
            
            showResults(correct, total);
        }
        
        // Sentence Builder Exercise
        function generateSentenceBuilder(items, container) {
            container.innerHTML = `
                <h3 style="color: var(--primary); margin-bottom: 25px;">üèóÔ∏è Sentence Builder</h3>
                <p style="color: var(--text-light); margin-bottom: 30px;">Create your own sentences using these words and phrases.</p>
            `;
            
            items.forEach((item, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card';
                questionDiv.innerHTML = `
                    <div class="question-text">${index + 1}. Use "${item.word}" in a sentence</div>
                    <div style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">
                        üí° Meaning: ${item.definition}
                    </div>
                    <textarea class="form-textarea" id="sentence${index}" placeholder="Write your sentence here..." rows="3"></textarea>
                `;
                
                container.appendChild(questionDiv);
            });
            
            const submitBtn = document.createElement('button');
            submitBtn.className = 'btn btn-success';
            submitBtn.textContent = '‚úì Submit for Review';
            submitBtn.style.marginTop = '30px';
            submitBtn.onclick = () => submitSentenceBuilder(items);
            
            container.appendChild(submitBtn);
        }
        
        function submitSentenceBuilder(items) {
            let completed = 0;
            
            items.forEach((item, index) => {
                const textarea = document.getElementById('sentence' + index);
                if (textarea.value.trim().length > 0) {
                    completed++;
                    textarea.classList.add('correct');
                    textarea.disabled = true;
                }
            });
            
            const resultsDiv = document.createElement('div');
            resultsDiv.className = 'results-card';
            resultsDiv.innerHTML = `
                <div class="results-score">‚ú®</div>
                <div class="results-message">Great job!</div>
                <p>You completed ${completed} out of ${items.length} sentences.</p>
                <p style="margin-top: 15px;">Keep practicing to improve your writing skills!</p>
            `;
            
            document.getElementById('exerciseContent').appendChild(resultsDiv);
            
            stats.exercisesCompleted++;
            saveData();
        }
        
        // Show results
        function showResults(correct, total) {
            const percentage = Math.round((correct / total) * 100);
            let message = '';
            let emoji = '';
            
            if (percentage === 100) {
                message = 'Perfect! Outstanding work! üéâ';
                emoji = 'üèÜ';
            } else if (percentage >= 80) {
                message = 'Excellent! Keep it up! üí™';
                emoji = '‚≠ê';
            } else if (percentage >= 60) {
                message = 'Good job! Keep practicing! üëç';
                emoji = '‚úÖ';
            } else {
                message = 'Keep learning! You can do it! üìö';
                emoji = 'üí°';
            }
            
            const resultsDiv = document.createElement('div');
            resultsDiv.className = 'results-card';
            resultsDiv.innerHTML = `
                <div class="results-score">${emoji}</div>
                <div class="results-message">${message}</div>
                <div style="font-size: 48px; margin: 20px 0;">${correct} / ${total}</div>
                <div style="font-size: 24px;">${percentage}% Correct</div>
            `;
            
            document.getElementById('exerciseContent').appendChild(resultsDiv);
            
            // Update stats
            stats.exercisesCompleted++;
            stats.correctAnswers += correct;
            stats.totalAnswers += total;
            saveData();
        }
        
        // Initialize
        updateStats();
        displayVocabulary();
    </script>
</body>
</html>